import{j as h,N as p,bx as k,A as N,s as V,b as z,o as d,c,d as a,f as n,h as U,w as M,by as P,i as b,C,D as v,H as D,F,k as T,E as S,I as A,G as O,g as j,t as I}from"./app-2c444acf.js";function J(){const m=h([]),f=h([]),o=h(""),s=h(0),w=h(!1),r=h(1);return{isAll:w,page:r,users:m,user:f,errors:o,loading:s,deleteUserData:async t=>{o.value="";try{s.value=!0;let e=await p.post("/api/users-delete-data",t,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=!1}catch(e){if(s.value=0,e.response.status==422)for(const l in e.response.data.errors)o.value+=e.response.data.errors[l][0]+`	
`;else e.response.status==401&&(o.value=e.response.data.message)}},getUsers:async()=>{try{o.value="",s.value=!0;let t=await p.get("/api/users",{headers:{Authorization:`Bearer ${localStorage.token}`}});m.value=t.data.data,s.value=!1}catch(t){t.response.status==401&&(k.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},getUser:async t=>{o.value="";try{s.value=!0;let e=await p.get("/api/users/"+t,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=0,f.value=e.data.data}catch(e){e.response.status==401&&(k.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},createUser:async t=>{o.value="";try{s.value=!0,await p.post("/api/users",t,{headers:{Authorization:`Bearer ${localStorage.token}`}}),s.value=!1}catch(e){if(e.response.status==422){s.value=0;for(const l in e.response.data.errors)o.value+=e.response.data.errors[l][0]+`
`}}},updateUser:async(t,e)=>{o.value="";try{s.value=!0;let l=await p.post("/api/users/"+t,e,{headers:{Authorization:`Bearer ${localStorage.token}`,"Content-Type":"multipart/form-data"}});s.value=!1,localStorage.user=JSON.stringify(l.data.data),location.reload()}catch(l){if(s.value=0,l.response.status==422)for(const g in l.response.data.errors)o.value+=l.response.data.errors[g][0]+`	
`}},destroyUser:async t=>{o.value="";try{return s.value=!0,await p.delete(`/api/users/${JSON.stringify(t)}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),s.value=!1,!0}catch{s.value=0,o.value="Impossible de supprimer ce user"}},updatePasswordUser:async(t,e)=>{o.value="";try{s.value=!0,await p.put("/api/users-change-password/"+t,e,{headers:{Authorization:`Bearer ${localStorage.token}`}}),s.value=!1}catch(l){if(s.value=0,l.response.status==422)for(const g in l.response.data.errors)o.value+=l.response.data.errors[g][0]+`	
`;else l.response.status==401&&(o.value=l.response.data.message)}},updateStatusUser:async(t,e)=>{o.value="";try{s.value=!0;let l=await p.put("/api/users-change-status/"+t,e,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=!1,localStorage.user=JSON.stringify(l.data.data)}catch(l){if(s.value=0,l.response.status==422)for(const g in l.response.data.errors)o.value+=l.response.data.errors[g][0]+`	
`}},destroyUserFront:async t=>{o.value="";try{s.value=!0;let e=await p.post("/api/users-delete-user",t,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=!1}catch(e){if(s.value=0,e.response.status==422)for(const l in e.response.data.errors)o.value+=e.response.data.errors[l][0]+`	
`;else e.response.status==401&&(o.value=e.response.data.message)}},getUsersType:async t=>{try{o.value="",s.value=!0;let e=await p.get("/api/users-type/"+t+"?page="+r.value,{headers:{Authorization:`Bearer ${localStorage.token}`}});r.value==1?m.value=e.data.data:m.value=m.value.concat(e.data.data),s.value=!1,e.data.data.length==0&&(w.value=!0)}catch(e){e.response.status==401&&(k.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},filterUsers:async t=>{o.value="";try{s.value=3;let e=await p.post("/api/users-filter",t,{headers:{Authorization:`Bearer ${localStorage.token}`}});m.value=e.data.data,s.value=!1}catch(e){e.response.status==401&&(k.push({name:"login",params:{redirect:"not-login"}}),window.localStorage.removeItem("token"),window.localStorage.removeItem("user"))}},updateUser2:async()=>{o.value="";try{s.value=!0;let t=await p.put("/api/users-update/"+f.value.id,f.value,{headers:{Authorization:`Bearer ${localStorage.token}`}});s.value=!1}catch(t){if(s.value=0,t.response.status==422)for(const e in t.response.data.errors)o.value+=t.response.data.errors[e][0]+`	
`}}}}const G={class:"relative min-h-screen w-full bg-white xl:mt-0 xl:p-4"},R={class:"z-0 w-full p-4"},q=a("div",{class:"flex w-full justify-between bg-white px-8 py-5"},[a("h1",{class:"text-4xl font-bold capitalize text-primary-blue"}," Edit User ")],-1),H={class:"mx-auto w-full bg-white p-6"},L=a("h2",{class:"text-md font-light text-gray-700"}," Edit a new User ",-1),K={class:"w-full"},Q=a("label",{class:""},"Type de profil",-1),W=["value"],X={class:"w-full mt-3"},Y={class:""},Z={key:0},ee={key:1},se={key:2},ae={key:3},te={key:4},oe={key:0,class:"w-full mt-3"},re=a("label",{class:""},"Prénom du Fidele",-1),le={key:1,class:"w-full mt-3"},ne=a("label",{class:""},"Chargé paroissial",-1),ue={class:"flex mt-1 items-center space-x-2"},ie=a("label",{for:"yes"},"Oui",-1),de=a("label",{for:"no"},"Non",-1),pe={class:"w-full mt-3"},ce=a("label",{class:""},"Adresse mail",-1),me={class:"w-full mt-3"},ve=a("label",{class:""},"Mot de passe",-1),fe={class:"relative mt-1"},ye=["type"],he=a("div",{class:"mt-6 flex justify-end"},[a("button",{type:"submit",class:"rounded bg-blue-300 px-6 py-2 leading-5 text-white focus:outline-none"}," save ")],-1),Ue={__name:"UserEdit",props:{id:{required:!0}},setup(m){const f=m,o=N(),{updateUser2:s,getUser:w,user:r,errors:_,loading:E}=J();V(async()=>{await w(f.id)});const x=async()=>{await s(),_.value==""&&o.push({name:"admin.user.index"})};return(y,i)=>{const B=z("EyeIcon"),$=z("EyeSlashIcon");return d(),c("div",G,[a("div",R,[q,a("section",H,[n(_)!=""?(d(),U(P,{key:0},{default:M(()=>[j(I(n(_)),1)]),_:1})):b("",!0),L,a("form",{onSubmit:i[8]||(i[8]=C(u=>x(),["prevent"])),id:"userform"},[a("div",K,[Q,v(a("select",{"onUpdate:modelValue":i[0]||(i[0]=u=>n(r).user_type=u),class:"form-select p-2 outline-none mt-1 border block border-gray-300 rounded-lg shadow-sm w-full"},[(d(!0),c(F,null,T(y.roles,u=>(d(),c("option",{key:u.id,value:u.id},I(u.name),9,W))),128))],512),[[D,n(r).user_type]])]),a("div",X,[a("label",Y,[n(r).user_type=="faithful"?(d(),c("span",Z,"Nom du Fidele")):n(r).user_type=="parish"?(d(),c("span",ee,"Nom de la Paroisse")):n(r).user_type=="prayerGroup"?(d(),c("span",se,"Nom du groupe de prière ")):n(r).user_type=="diocese"?(d(),c("span",ae,"Nom du diocèse ")):n(r).user_type=="seat"?(d(),c("span",te,"Nom du Siège ")):b("",!0)]),v(a("input",{"onUpdate:modelValue":i[1]||(i[1]=u=>n(r).username=u),class:"border-gray-300 mt-1 border form-input p-2 outline-none block rounded-lg shadow-sm w-full",type:"text",placeholder:"Ex: Marc"},null,512),[[S,n(r).username]])]),n(r).user_type=="faithful"?(d(),c("div",oe,[re,v(a("input",{"onUpdate:modelValue":i[2]||(i[2]=u=>n(r).lastname=u),class:"border-gray-300 mt-1 border form-input p-2 outline-none block rounded-lg shadow-sm w-full",type:"text",placeholder:"Ex: Emmanuel"},null,512),[[S,n(r).lastname]])])):b("",!0),n(r).user_type=="faithful"?(d(),c("div",le,[ne,a("div",ue,[v(a("input",{type:"radio",class:"form-radio border-gray-300",id:"yes","onUpdate:modelValue":i[3]||(i[3]=u=>n(r).parish_official=u),value:!0},null,512),[[A,n(r).parish_official]]),ie,v(a("input",{type:"radio",class:"form-radio border-gray-300",id:"no","onUpdate:modelValue":i[4]||(i[4]=u=>n(r).parish_official=u),value:!1},null,512),[[A,n(r).parish_official]]),de])])):b("",!0),a("div",pe,[ce,v(a("input",{"onUpdate:modelValue":i[5]||(i[5]=u=>n(r).email=u),class:"border-gray-300 border form-input p-2 mt-1 outline-none block rounded-lg shadow-sm w-full",type:"email",placeholder:"Ex: nom@xyz.com"},null,512),[[S,n(r).email]])]),a("div",me,[ve,a("div",fe,[v(a("input",{"onUpdate:modelValue":i[6]||(i[6]=u=>n(r).password=u),class:"border-gray-300 border form-input py-2 pr-10 outline-none block rounded-lg shadow-sm w-full",type:y.showPassword?"text":"password",placeholder:"8+ caracteres"},null,8,ye),[[O,n(r).password]]),a("span",{class:"absolute top-3 right-4 cursor-pointer",onClick:i[7]||(i[7]=u=>y.showPassword=!y.showPassword)},[y.showPassword?(d(),U($,{key:1,class:"w-5 h-5 text-gray-500"})):(d(),U(B,{key:0,class:"w-5 h-5 text-gray-500"}))])])]),he],32)])])])}}};export{Ue as default};
